<p-table #toolsTable
         id="tools"
         [value]="tools"
         [lazy]="true"
         (onLazyLoad)="loadToolsLazy($event)"
         [paginator]="true"
         [rows]="30"
         [totalRecords]="totalTools"
         [loading]="loadingTools"
         [rowsPerPageOptions]="[10,20,30,50,100]"
         [showCurrentPageReport]="true"
         [sortField]="'name'"
         [sortOrder]="1"
         styleClass="p-datatable-sm"
         dataKey="name">
  <ng-template pTemplate="header">
    <tr>
      <th style="width: 60px;"></th>
      <th style="width: 80px;" pSortableColumn="id">ID <p-sortIcon field="id"></p-sortIcon></th>
      <th style="width: 200px;" pSortableColumn="name">Name <p-sortIcon field="name"></p-sortIcon></th>
      <th style="width: 200px;" pSortableColumn="location">Location <p-sortIcon field="name"></p-sortIcon></th>
      <th style="width: 200px;" pSortableColumn="entry">Entry <p-sortIcon field="name"></p-sortIcon></th>
      <th style="width: 200px;" pSortableColumn="version">Version <p-sortIcon field="name"></p-sortIcon></th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-tool let-expanded="expanded">
    <tr>
        <td>
            <button type="button" pButton pRipple [pRowToggler]="tool" class="p-button-text p-button-rounded p-button-plain" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
        </td>
        <td>{{ tool.id }}</td>
        <td><a routerLink="/tools/{{ tool.id }}">{{ tool.name }}</a></td>
        <td>{{ tool.location }}</td>
        <td>{{ tool.entry }}</td>
        <td>{{ tool.version }}</td>
    </tr>
  </ng-template>
  <ng-template pTemplate="rowexpansion" let-tool>
      <tr style="background-color: #eee;">
          <td colspan="6">
              <div>
                  {{ tool.description }}
              </div>
              <table>
                  <tr>
                      <th>Parameter</th>
                      <th>Type</th>
                      <th>Default Value</th>
                      <th>Enum</th>
                      <th>Description</th>
                  </tr>
                  <tr *ngFor="let f of tool.fields.properties | keyvalue">
                      <td>{{ f.key }}</td>
                      <td>
                          {{ f.value["type"] }}
                      </td>
                      <td>
                          {{ f.value.default }}
                      </td>
                      <td>
                          {{ f.value.enum }}
                      </td>
                      <td>
                          {{ f.value.description }}
                      </td>
                  </tr>
              </table>
              <button pButton type="button" label="Show Raw Schema" (onClick)="showRawSchema()" class="p-button-sm p-button-outlined p-button-secondary"></button>
              <!--<pre>{{ tool.fieldsJson }}</pre>-->
          </td>
      </tr>
  </ng-template>
</p-table>
