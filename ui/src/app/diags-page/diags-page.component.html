<app-tabbed-page baseLinkUrl="/diagnostics" (tabChanged)="handleTabChange($event)">
  <app-tabbed-page-tab label="Overview">
    <div style="display: flex;">
      <div *ngFor="let s of data | keyvalue" class="m-2">
        <p-card>
          <ng-template pTemplate="title">
            {{ s.value.name }}
            <i *ngIf="s.value.open" class="pi pi-check-circle" style="font-size: 1em; color: green;"></i>
            <i *ngIf="!s.value.open" class="pi pi-times-circle" style="font-size: 1em; color: red;"></i>
          </ng-template>
          <ng-template pTemplate="subtitle">
            {{ s.value.address }}
          </ng-template>

          <div *ngIf="s.key === 'rq'">
            <b>Scheduled Jobs:</b>
            <div *ngFor="let t of s.value.scheduled_jobs">
                {{ t.created_at | localtime }} {{ t.description }}
            </div>
            <div *ngIf="!s.value.scheduled_jobs || s.value.scheduled_jobs.length === 0">
              no scheduled jobs
            </div>

            <b>Current Jobs:</b>
            <div *ngFor="let t of s.value.current_jobs">
                {{ t.created_at | localtime }} {{ t.description }}
            </div>
            <div *ngIf="!s.value.current_jobs || s.value.current_jobs.length === 0">
              no current jobs
            </div>

            <b>Failed Jobs:</b>
            <div *ngFor="let t of s.value.failed_jobs">
                {{ t.ended_at | localtime }} {{ t.description }}
            </div>
            <div *ngIf="!s.value.failed_jobs || s.value.failed_jobs.length === 0">
              no failed jobs
            </div>

            <b>Finished Jobs:</b>
            <div *ngFor="let t of s.value.finished_jobs">
                {{ t.ended_at | localtime }} {{ t.description }}
            </div>
            <div *ngIf="!s.value.finished_jobs || s.value.finished_jobs.length === 0">
              no finished jobs
            </div>

            <b>Deferred Jobs:</b>
            <div *ngFor="let t of s.value.deferred_jobs">
                {{ t.started_at | localtime }} {{ t.description }}
            </div>
            <div *ngIf="!s.value.deferred_jobs || s.value.deferred_jobs.length === 0">
              no deferred jobs
            </div>
          </div>

        </p-card>
      </div>
    </div>
  </app-tabbed-page-tab>

  <app-tabbed-page-tab label="Logs">
      <app-simple-logs-panel
          [visible]="logsPanelVisible"
          [topOffset]="250"
          [logLevel]="logLevel"></app-simple-logs-panel>
  </app-tabbed-page-tab>
</app-tabbed-page>
