<p-tabView [(activeIndex)]="tabIndex" (onChange)="handleTabChange($event)">
  <p-tabPanel header="Overview">
    <div *ngFor="let s of data | keyvalue" style="display: flex;">
      <div style="width: 20em; margin: 0 0 20px 0;">
        <div style="font-size: 1.5em;">{{ s.value.name }}</div>
        <div style="font-size: 0.8em;">{{ s.value.address }}</div>
      </div>
      <div>
        <i *ngIf="s.value.open !== 'true'" class="pi pi-check-circle" style="font-size: 2em; color: green;"></i>
        <i *ngIf="s.value.open === 'true'" class="pi pi-times-circle" style="font-size: 2em; color: red;"></i>
      </div>
    </div>
  </p-tabPanel>

  <p-tabPanel header="Celery">
    <div>
      <h3>Current Tasks</h3>
      <div *ngFor="let t of data.celery.current_tasks">
        {{ t }}
      </div>

      <h3>Last Tasks Logs</h3>
      <div style="display: flex;">
        <table style="margin-right: 30px;">
          <tr *ngFor="let t of data.celery.last_tasks">

            <td style="padding-right: 2em;">{{ t[0] | localtime }}</td>
            <td style="padding-right: 2em;">{{ t[1] }}</td>
            <td>
              <p-button label="Show {{ t[2] }} lines" icon="pi pi-refresh" styleClass="p-button-sm p-button-outlined" (onClick)="showCeleryLogs(t[1])"></p-button>
            </td>
          </tr>
        </table>

        <div style="height: 500px; width: 80em; font-family: monospace; font-size: 0.8em; color: #eee; background-color: #222; padding: 10px; overflow-y: scroll;">
          <div *ngFor="let l of celeryLogs">
            <span style="padding-right: 2em;"> {{ l.time | localtime }}</span>
            {{ l.message }}
          </div>
        </div>
      </div>

    </div>
  </p-tabPanel>

  <p-tabPanel header="Logs">
    <div style="display: flex;">
      <p-selectButton [options]="logServices" [(ngModel)]="logServicesSelected" multiple="multiple" optionLabel="name" optionValue="value" (onChange)="loadServicesLogs()"></p-selectButton>
      <p-button label="Refresh" icon="pi pi-refresh" (onClick)="loadServicesLogs()" [style]="{'margin-left': '30px'}" [loading]="servicesLogsAreLoading"></p-button>
    </div>

    <div style="display: flex; margin: 6px 0 0 6px;">
      <div class="p-field p-grid">
        <label for="log-level" class="p-col-fixed" style="width:100px">Log Level</label>
        <div class="p-col">
          <p-dropdown id="log-level"  [options]="logLevels" [(ngModel)]="logLevel" (onChange)="loadServicesLogs()"></p-dropdown>
        </div>
      </div>
    </div>

    <div style="height: calc(100vh - 24em); width: 100%; font-family: monospace; font-size: 0.8em; color: #eee; background-color: #222; padding: 10px; overflow-y: scroll;">
      <div *ngFor="let l of servicesLogs" style="display: flex;">
        <div style="width: 13em; margin-right: 1em; flex: none;"> {{ l.time | localtime }}</div>
        <div style="width: 7em; margin-right: 1em; flex: none;"> {{ l.host }}</div>
        <div style="width: 7em; margin-right: 1em; flex: none;"> {{ l.service }}</div>
        <div style="width: 9em; margin-right: 1em; flex: none; overflow-x: hidden;"> {{ l.tool }}</div>
        <div style="width: 4em; margin-right: 1em; flex: none;" [ngClass]="'level-' + l.level.slice(0, 4).toLowerCase()"> {{ l.level.slice(0, 4) }}</div>
        <div style="white-space: pre-wrap; word-break: break-word;">{{ l.message }}</div>
      </div>
    </div>
  </p-tabPanel>

</p-tabView>
